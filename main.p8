pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--main

-- screen values
screen_title=0
screen_intro=1 -- not implemented
screen_game=2

frame_count=0

function _init()
	screen=screen_title
	player_setup()
	make_player()
	
	arrow_setup()
end

function _update60()
	update_game()
end

background=0
function _draw()

	cls(background)
	frame_count+=1
	if(screen==screen_title)draw_title()
	if(screen==screen_intro)draw_intro()
	
	if(screen==screen_game) then
		draw_game()
	end
end

-- title
function draw_title()
	print("cupid cupid!", 4, 64-8)
	if(frame_count%25<10) then
		print("[press ❎ to play]", 4, 64+8)
	end
		
	if(btn(❎)) then
		screen=screen_game
	end
end

-- intro
function draw_intro()
	
end

-- game
function draw_game()
 map()
	foreach(player,draw_player)
	foreach(arrows,draw_arrow)
end

function update_game()
	foreach(player,update_player)
	foreach(arrows,update_arrow)
end

-->8
--player
function player_setup()
	player={}
end

function make_player()
	local p={}
	p.x=20
	p.y=64
	p.dx=0
	p.dy=0
	p.sprite=3
	add(player,p)
end


friction=0.65
function update_player(p)
	p.dx*=friction
	p.dy*=friction

	if btn(⬆️) then p.dy-=0.9 end
	if btn(⬇️) then p.dy+=0.9 end
	if btn(⬅️) then p.dx-=0.9 end
	if btn(➡️) then p.dx+=0.9 end
	
	if btnp(❎) then
		sfx(0)
		make_arrow(p.x,p.y) 
	end
	
	if p.dx*p.dy != 0 then
			p.dx*=0.707
			p.dy*=0.707
	end
	p.x+=p.dx
	p.y+=p.dy
	
	if p.x <=0 then p.x=0 end
	if p.x >=113 then p.x=113 end
	if p.y <=0 then p.y=0 end
	if p.y >=113 then p.y=113 end
	
end

function draw_player(p)
	spr(3,p.x,p.y,2,2)
end


--projectile logic
function arrow_setup()
	arrows={}
end

function make_arrow(x,y)
	local arrow={}
	arrow.x=x+3
	arrow.y=y
	arrow.sprite=5
	add(arrows,arrow)
end

function update_arrow(arrow)
	arrow.x+=1
end

function draw_arrow(arrow)
	spr(5,arrow.x+3,arrow.y,2,2)
end
-->8
--enemies
-->8
--background
__gfx__
000000000000000000000000000000aaaaa000000000000000000000ccccccccccccccccccccc66666666ccccccccccccccccccc000000000000000000000000
00000000000000000000000000000aaaaa4a00000000000000000000cccccccccc677ccccccc6777777766cccccccccccccccccc000000000000000000000000
0070070000000000000000000000aaaaa74400000000000000000000cccccccc66677776cccc6777777776cccccccccccccccccc000000000000000000000000
0007700000000000000000000000aaff7ff440000000000000000000cccccccc67777777c66677777777766ccccccccccccccccc000000000000000000000000
0007700000000000000000007700aaf7ff1f40000000000000000000cccccccc677777776676677777777776cccccccccccccccc000000000000000000000000
0070070000677700007776007670af71ff1f44008800000008e00000cccccccc677777766777667777777776cccccccccccccccc000000000000000000000000
00000000077777000077777076700f7ffffe040088800000008e0000cccccccc667776666777777777777776cccccccccccccccc000000000000000000000000
0000000007776770077677700667797ffff004000888888888888000cccccccccc6666cc6777777777777776cc6666666ccccccc000000000000000000000000
0000000077776777777677770766fff4fffff50088822222222e000066676677cccccccc6677777777777776c677777776cc666c000000000000000000000000
0000000076767767767767670006fff4fffff5008800000002e0000077766767ccccccccc6777777677777766777777777667776000000000000000000000000
0000000076767767767767670000007666004400000000000000000077777776ccccccccc66667666777776c6777777776677777000000000000000000000000
0000000076077670076770670000006766004000000000000000000077777676cccccccc666666666666666cc677777776777777000000000000000000000000
000000007000760000670007000000f67f044000000000000000000077766776cccccccccccccccccccccccccc66777777777777000000000000000000000000
0000000000000000000000000000fff0f744000000000000000000006766776ccccccccccccccccccccccccccccc667777777777000000000000000000000000
0000000000000000000000000000ff0ff04000000000000000000000c66666cccccccccccccccccccccccccccccccc6666666666000000000000000000000000
00000000000000000000000000000000000000000000000000000000cccccccccccccccccccccccccccccccccccccccccccccccc000000000000000000000000
__map__
070707070707070707070c0c090a070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070c1b1c171a070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07070707070707070707070c0707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070c07070c07070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07070707070707070c1b1c08090a070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070707070707070708171c08191a070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0707070707070707070707070707070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
00020000296700000022650000001a6400000010620000000a6100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
